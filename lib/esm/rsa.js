import{__awaiter as e,__generator as t}from"./_virtual/_tslib.js";import r from"inquirer";import n from"node-forge";import{writeFileContent as i,deleteFile as o}from"./file.js";import{Encryption as c}from"./types.js";import{getPath as a}from"./utils.js";import u from"chalk";var getRsa=function(){return new Promise(function(e,t){try{var r=n.pki.rsa.generateKeyPair({bits:2048}),i=n.pki.privateKeyToPem(r.privateKey),o=n.pki.publicKeyToPem(r.publicKey);e({privateKey:i,publicKey:o})}catch(e){t(e)}})},createRsa=function(){return e(void 0,void 0,void 0,function(){var e,r,o,s,p;return t(this,function(t){switch(t.label){case 0:return[4,getRsa()];case 1:return r=(e=t.sent()).privateKey,o=e.publicKey,s=n.util.encode64(r),p=n.util.encode64(o),[4,i(a("".concat(c.RSA,".private")),s)];case 2:return t.sent(),[4,i(a(c.RSA),p)];case 3:return t.sent(),console.log(u.red("RSA Private Key:")+u.yellow(" ".concat(s))),console.log(u.red("RSA Public Key:")+u.yellow(" ".concat(p))),[2,p]}})})},decrypt=function(e,t){return new Promise(function(r,i){e&&t||i();try{var o=n.util.decode64(e),c=n.pki.privateKeyFromPem(o),a=n.util.decode64(t),u=c.decrypt(a);r(u)}catch(e){i(e)}})},encrypt=function(e,t){return new Promise(function(r,i){e&&t||i();try{var o=n.util.decode64(e),c=n.pki.publicKeyFromPem(o).encrypt(t);r(n.util.encode64(c))}catch(e){i(e)}})},setRsa=function(){return e(void 0,void 0,void 0,function(){var e;return t(this,function(t){switch(t.label){case 0:return[4,r.prompt([{type:"input",name:"privateKey",message:"Enter your key:"},{type:"input",name:"key",message:"Enter your Pubkey:"}])];case 1:return e=t.sent(),[4,i(a("".concat(c.RSA,".private")),e.privateKey)];case 2:return t.sent(),[4,i(a("".concat(c.RSA)),e.key)];case 3:return t.sent(),[2]}})})},del=function(){return e(void 0,void 0,void 0,function(){return t(this,function(e){switch(e.label){case 0:return[4,o(a(c.RSA))];case 1:return e.sent(),[4,o(a("".concat(c.RSA,".private")))];case 2:return e.sent(),[2]}})})};export{createRsa,decrypt,del,encrypt,getRsa,setRsa};
